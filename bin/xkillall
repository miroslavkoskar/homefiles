#!/bin/bash

set -e

_usage() {
    echo "usage: $(basename "$0") [-f] pattern"
}
usage() { _usage; exit 0; }
usage_err() { _usage >&2; exit 2; }

while getopts 'fh' opt; do
    case $opt in
        f)
            fopt='-f'
            ;;
        h)
            usage
            ;;
        *)
            usage_err
            ;;
    esac
done
shift $((OPTIND-1))

[ $# -eq 0 ] && usage_err

xpgrep_opts=($fopt)
xpgrep "${xpgrep_opts[@]}" "$1" | xargs -r killer -g
