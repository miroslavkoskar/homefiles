#!/usr/bin/env bash

set -eu
shopt -s nullglob

ifaces=()
for dev in /sys/class/net/*; do
    [[ $(<"$dev/operstate") = 'up' ]] || continue
    ifaces+=("${dev##*/}")
done

if (( ! ${#ifaces[@]} )); then
    echo 'There are no operational interfaces to be found.' >&2
    exit 1
fi

exec 2>/dev/null
sudo /usr/bin/nethogs "$@" "${ifaces[@]}"
