#!/usr/bin/env bash

set -eu

cd /sys/class/net

ifaces=()
for i in *; do
    [[ $(<"$i/operstate") = 'up' ]] || continue
    ifaces+=($i)
done

if (( ! ${#ifaces[@]} )); then
    echo 'There are no operational interfaces to be found.' >&2
    exit 1
fi

sudo /usr/bin/nethogs "$@" "${ifaces[@]}"
