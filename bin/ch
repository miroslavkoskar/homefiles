#!/usr/bin/env bash
#
# See also: http://peter.sh/experiments/chromium-command-line-switches/

set -e

prgname=${0##*/}

proxy=()
if [[ $prgname != 'ch0' ]]; then
    proxy=(
        --proxy-server='127.0.0.1:8118'
        #--proxy-bypass-list='<local>'
    )
fi

logging=()
if [[ $CH_DEBUG ]]; then
    logging=(
        --debug-plugin-loading
        --enable-extension-activity-logging
        --enable-logging=stderr
        --v=1
    )
fi

exec /opt/google/chrome/google-chrome \
    --force-device-scale-factor=1 \
    --force-gpu-rasterization \
    --ignore-gpu-blacklist \
    --restore-last-session \
    "${proxy[@]}" \
    "${logging[@]}" \
    "$@"
