#!/bin/bash

set -e

# startx unsets DBUS_SESSION_BUS_ADDRESS, let's set it back
export DBUS_SESSION_BUS_ADDRESS="unix:path=$XDG_RUNTIME_DIR/bus"

if [ -d /etc/X11/xinit/xinitrc.d ]; then
    for i in /etc/X11/xinit/xinitrc.d/* ; do
        [ -f "$i" ] && source "$i"
    done
fi

xresources=~/.Xresources
if [ -e "$xresources" ]; then
    xrdb -load "$xresources"
fi

xmodmap=~/.Xmodmap
if [ -e "$xmodmap" ]; then
    xmodmap "$xmodmap"
fi

xkb
xscreen

_main() {
    osdd &
    twmnd &
    workrave &
    _xmonad
}

_openbox() {
    tint2 &
    openbox
}

_xmonad() {
    tray &
    xmonad
}

[ $# -gt 0 ] && eval "$*"
