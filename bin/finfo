#!/usr/bin/env bash

set -eu

if (( $# )); then
    ifile=$1
    echo
    stat -- "$ifile"
else
    tmpfile=$(mktemp)
    cleanup() { rm -f "$tmpfile"; }
    trap cleanup EXIT
    cat >"$tmpfile"
    ifile=$tmpfile
fi

echo
file -b --mime -- "$ifile"
file -b -- "$ifile"
echo

[[ -f $ifile ]] || exit 0

tmp=$(wc "$ifile")
read -r lines words bytes _ <<<"$tmp"
printf '%d bytes, %d words, %d lines\n' "$bytes" "$words" "$lines"
echo

declare -i n=128
echo "(Canonical hexdump limited to first $n bytes)"
hexdump -C -n "$n" "$ifile"
echo
