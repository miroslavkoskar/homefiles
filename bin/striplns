#!/usr/bin/env bash

set -eu

prgname=${0##*/}

declare -i squash=0
[[ $prgname = 'squashlns' ]] && squash=1

awk -v squash=$squash '
/^\s*$/ {
    if (txt) sep = (squash ? 1 : sep + 1)
    next
}
{
    txt = 1
    for (i=0; i<sep; i++) printf "\n"
    sep = 0
    print
}'
