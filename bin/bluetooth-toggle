#!/usr/bin/env bash

set -eu

state=$(rfkill-state -a bluetooth)
case $state in
    -1 | 1)
        rfkill block bluetooth
        ;;
    0)
        rfkill unblock bluetooth
        sleep 1

#        dbus-send --system --type=method_call --dest=org.bluez \
#            /org/bluez/hci0 \
#            org.freedesktop.DBus.Properties.Set \
#            string:org.bluez.Adapter1 string:Powered variant:boolean:true
#
#        dbus-send --system --type=method_call --dest=org.bluez \
#            /org/bluez/hci0 \
#            org.freedesktop.DBus.Properties.Set \
#            string:org.bluez.Adapter1 string:Pairable variant:boolean:false

        bluetoothctl <<<$'power on\npairable off' >/dev/null
        ;;
esac

status-osd bluetooth
