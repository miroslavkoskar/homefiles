#!/usr/bin/env bash

set -eu -o pipefail

pid=${1:-$PPID}

[ "$pid" -gt 0 ] 2>/dev/null || {
    echo "usage: ${0##*/} pid" >&2
    exit 2
}

main() {
    ifile="/proc/$pid/environ"
    [[ -r $ifile ]] && xargs -0 -n1 -x -r -a "$ifile" shell-escape
}

if [[ -t 1 ]]; then
    main | $PAGER
else
    main
fi
