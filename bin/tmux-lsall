#!/usr/bin/env bash

set -eu
shopt -s nullglob

prgname=${0##*/}

if [[ $prgname = 'tmux-killall' ]]; then
    [[ ${TMUX-} ]] && exit 1
    cmd='kill-server'
else
    cmd='ls'
fi

echo
for socket in "${TMUX_TMPDIR:-/tmp}/tmux-$UID/"*; do
    echo "> $socket"
    tmux -S "$socket" "$cmd" || true
    echo
done
