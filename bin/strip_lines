#!/usr/bin/env bash

set -eu

prgname=${0##*/}

[[ $prgname = 'squash' ]] && squash=1

awk -v squash=$squash '
/^\s*$/ {
    if (seen_text) {
        new_lines = (squash ? "" : new_lines) "\n"
    }
    next
}
{
    seen_text = 1
    print new_lines
    new_lines = ""
    print
}'
