#!/usr/bin/env bash

set -eu

prgname=${0##*/}

case ${1-} in -h|--help)
    echo "usage: $prgname [profile] [arg]..."
    exit
    ;;
esac

# ----------------------------------------

profiles=(
    devel
    lab
    plain
    proxy
    proxy-socks
    proxy-tor
)

profile=
if (( $# )); then
    for p in "${profiles[@]}"; do
        [[ $p = "$1" ]] || continue
        profile=$1
        shift
        break
    done
fi

if [[ ! $profile ]]; then
    profile=$(IFS=$'\n'; dmenu1 "$prgname" <<<"${profiles[*]}")
fi

[[ ! $profile ]] && exit 1

exec ch0 --user-data-dir="$HOME/.config/google-chrome-$profile" "$@"
