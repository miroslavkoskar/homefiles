#!/bin/bash

set -e

while getopts 'gs:' opt; do
    case "$opt" in
        g)
            gopt=1
            ;;
        s)
            sopt="$OPTARG"
            ;;
        *)
            exit 1
            ;;
    esac
done
shift $((OPTIND-1))

sig="${sopt:-SIGTERM}"

[ $# -eq 0 ] && exit 1

for pid in "$@"; do
    if [ -n "$gopt" ]; then
        pgid="$(ps -p "$pid" -o pgid=)"
        [ -z "$pgid" ] && continue

        pkill --signal "$sig" -g "$pgid"
    else
        kill -s "$sig" "$pid"
    fi
done
