#!/usr/bin/env bash

set -eu

prgname=${0##*/}
dev='/dev/sr0'

case $prgname in
    sr0-blank)
        wodim dev="$dev" blank=all
        ;;
    sr0-iso)
        if (( ! $# )); then
            size=$(isosize "$dev")
            blocks=$((size/2048))
            output="sr0_$(date +%F.%s).iso"
            echo "Creating $output of following size: $((blocks/512)) MB"
            dd if="$dev" of="$output" bs=2048 count=$blocks
        else
            wodim -v -multi dev="$dev" "$1"
        fi
        ;;
    *)
        wodim dev="$dev" -checkdrive
        ;;
esac
