#!/usr/bin/env bash

set -eu -o pipefail

prgname=${0##*/}

export LC_ALL=C

name='SynPS/2 Synaptics TouchPad'
prop='Device Enabled'
id=$(xinput list | grep -F "$name" | xinput-ids | head -n1)

declare -i toggle=0
[[ $prgname = 'touchpad-toggle' ]] && toggle=1

if (( !toggle && $# )); then
    valset=$1
else
    declare -i val=0 valset=1
    val=$(xinput list-props "$id" | awk -F: "/^\s*$prop \(.*\):/ {print \$2}")
    (( val == valset )) && valset=0
    retstat=$?
    (( !toggle )) && exit $retstat
fi

xinput set-prop "$id" "$prop" "$valset"
status-osd touchpad
