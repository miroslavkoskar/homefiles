#!/bin/bash

set -eu

[ "${BASH_SOURCE:-}" ] && src=$(realpath -seq "$BASH_SOURCE") || exit 2

if [ $(id -u) -ne 0 ]; then
    sudo -- "$src" "$@"
    exit
fi

prgname=$(basename "$0")

cd /etc/hosts.d

{
case $prgname in
    hostsblock-off)
        mv 10-* off
        ;;
    hostsblock-antiad)
        mv 10-* off
        mv off/10-hostsblock .
        ;;
    *)
        mv off/10-* .
        ;;
esac
} 2>/dev/null || true

systemctl restart dnsmasq
