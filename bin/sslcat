#!/usr/bin/env bash

set -eu

prgname=${0##*/}

_usage() {
    echo "usage: $prgname {dsa | ec | req | rsa | x509} filename"
}
usage() { _usage; exit 0; }
usage_err() { _usage; exit 2; } >&2

while getopts 'h' opt; do
    case $opt in
        h)
            usage
            ;;
        *)
            usage_err
            ;;
    esac
done
shift $((OPTIND-1))

(( $# != 2 )) && usage_err

[[ -e $2 ]] || usage_err

case $1 in
    dsa | ec | rsa)
        openssl "$1" -in "$2"
        ;;
    x509)
        openssl "$1" -text -fingerprint -noout -in "$2"
        ;;
    req)
        openssl "$1" -text -noout -in "$2"
        ;;
    *)
        usage_err
        ;;
esac
