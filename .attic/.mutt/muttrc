# muttrc

# directories, files and commands
set alias_file          = ~/.mutt/aliases.muttrc                # where to store/get aliases
set header_cache        = ~/.mutt/cache/headers                 # where to store headers
set message_cachedir    = ~/.mutt/cache/messages                # where to store messages
set certificate_file    = ~/.mutt/certificates                  # where to store certs
set mailcap_path        = ~/.mutt/mailcap                       # entries for filetypes
#set signature           = ~/.mutt/signature                     # signature file
set tmpdir              = ~/.mutt/tmp                           # where to keep tmp files
set history_file        = ~/.mutt/history                       # where to store history
set editor              = 'vim +/^$ ++1 +noh'                   # use vim and skip to first blank line

# global includes
source $alias_file
source ~/.mutt/groups.muttrc
source ~/.mutt/colors.muttrc

# main options
set mbox_type           = Maildir
set history             = 100
set save_history        = 100
set timeout             = 10
set mail_check          = 0
set sleep_time          = 0
set reverse_alias                                               # show names from alias file in index
set quit                = ask-yes
unset mark_old                                                  # read/new is good enough for me
set beep_new                                                    # bell on new mails
set pipe_decode                                                 # strip headers and eval mimes when piping
set abort_nosubject     = ask-no
set abort_unmodified    = ask-no
set bounce              = ask-no
set recall              = ask-no

# index options
#set sort                = threads
#set sort                = reverse-date-received
set sort_aux            = reverse-date-received
set reply_regexp        = '^(([Rr][Ee]?(\[[0-9]+\])?: *)?(\[[^]]+\] *)?)*'
source ~/.mutt/sort-date.muttrc

# pager options
set pager_index_lines   = 11                                    # number of index lines to show
set pager_context       = 5                                     # number of context lines to show
set pager_stop                                                  # don't go to next message automatically
set menu_scroll                                                 # scroll in menus
set tilde                                                       # show tildes like in vim
unset markers                                                   # no ugly plus signs
auto_view text/html                                             # view html automatically
alternative_order text/plain text/enriched text/html            # save html for last
set quote_regexp        = '^( {0,4}[>|:#%]| {0,4}[a-z0-9]+[>|]+)+'

# formats
set date_format         = '%m/%d/%y at %I:%M%P'
set index_format        = '%3C [%Z] %D %-15.15F %s'
set alias_format        = '%4n %t %-20.20a  %r'
set query_format        = '%4c %t %-35.35a %-25.25n %?e?(%e)?'

# composing mail
set realname            = 'Miroslav Koskar'
set envelope_from
set edit_headers                                                # show headers when composing
set fast_reply                                                  # skip to compose when replying
set askcc                                                       # ask for CC:
set fcc_attach                                                  # save attachments with the body
set forward_format      = 'Fwd: %s'                             # format for subject when forwarding
set attribution         = 'On %d, %n wrote:'                    # set the attribution
set reply_to                                                    # reply to Reply to: field
set reverse_name                                                # reply as whomever it was to
set include                                                     # include message in replies
#set forward_quote                                               # include message in forwards
set mime_forward        = ask-no

# headers to show
ignore *                                                        # ignore all headers
unignore from: to: cc: date: subject:                           # show only these
hdr_order from: to: cc: date: subject:                          # and in this order

# imap globals
set imap_keepalive      = 600
unset imap_passive
#set imap_check_subscribed

# others
set ispell = 'aspell -e --email-margin=0 --run-together -c'
unset mail_check_recent
unset header_cache_compress
unset use_domain
unset wait_key

set folder = ~/
folder-hook . 'set folder = ~/; \
               unset move; unset mbox; \
               unset copy; unset record; \
               unset postpone; unset postponed; \
               unset smtp_url'

source ~/.mutt/accounts.muttrc

folder-hook . 'push "<change-folder>?<change-dir>^A^K=<enter><exit>"'

macro generic,pager <F1>    '<shell-escape>less /usr/share/doc/mutt/manual.txt<enter>' 'show Mutt documentation'
macro index,pager   \ev     '<pipe-message>urlview<enter>' 'follow links with urlview'
macro index,pager   y       '<change-folder>?<toggle-mailboxes>' 'show mailboxes list'
macro index,pager   Z       '<shell-escape>offlineimap-sync<enter>' 'run offlineimap'
macro index,pager   \ez     '<shell-escape>less ~/.offlineimap/log<enter>' 'show offlineimap log'
macro index,pager   \cO     '<query>' 'run external address query'
macro index,pager   \cR     '<tag-prefix><clear-flag>N' 'mark all tagged messages as read'

# generic bindings
# ------------------------------
#                   H           top-page
#                   j           next-entry
#                   k           previous-entry
#                   L           bottom-page
#                   \cL         refresh
#                   M           middle-page
#                   n           search-next
#                   q           exit
#                   t           tag-entry
bind generic        z           noop
bind generic        \cF         next-page
bind generic        Z           noop
bind generic        \cB         previous-page
bind generic        *           noop
bind generic        G           last-entry
bind generic        =           noop
bind generic        gg          first-entry
#                   :           enter-command
#                   >           next-line
#                   <           previous-line
bind generic        [           noop
bind generic        \cU         half-up
bind generic        ]           noop
bind generic        \cD         half-down
bind generic        ?           noop
bind generic        \e?         help
#                   ;           tag-prefix
#                   !           shell-escape
#                   <Return>    select-entry
#                   /           search
#                   \e/         search-reverse
bind generic        ?           search-reverse
bind generic        N           search-opposite
bind generic        z<Return>   current-top
bind generic        zt          current-top
bind generic        z.          current-middle
bind generic        zz          current-middle
bind generic        z-          current-bottom
bind generic        zb          current-bottom

# index/pager bindings
# ------------------------------
bind index,pager    \cF         next-page           # generic
bind index,pager    \cB         previous-page       # generic
bind index          G           last-entry          # generic
bind index          gg          first-entry         # generic
bind index,pager    \cU         half-up             # generic
bind index,pager    \cD         half-down           # generic
bind index,pager    \#          noop
bind index,pager    I           imap-fetch-mail
bind index,pager    &           noop
bind index          L           bottom-page         # generic
bind index,pager    N           search-opposite     # generic
bind index          J           next-unread
bind index          K           previous-unread
bind index,pager    \ej         next-entry
bind index,pager    \ek         previous-entry
bind index,pager    R           group-reply
bind pager          G           bottom
bind pager          gg          top
bind pager          j           next-line
bind pager          k           previous-line
bind pager          <Down>      next-line
bind pager          <Up>        previous-line
bind pager          J           next-undeleted
bind pager          K           previous-undeleted
bind pager          \e?         help
bind pager          <Return>    exit
bind index          \cG         noop

# alias bindings
# ------------------------------
bind alias          <Tab>       exit

# query bindings
# ------------------------------
bind query          \cO         exit

# attach bindings
# ------------------------------
bind attach         \cF         next-page           # generic
bind attach         \cB         previous-page       # generic
bind attach         G           last-entry          # generic
bind attach         gg          first-entry         # generic
bind attach         L           bottom-page         # generic

# browser bindings
# ------------------------------
bind browser        N           search-opposite     # generic

# editor bindings
# ------------------------------
bind editor         \cT         noop
bind editor         \cO         complete-query
bind editor         \cP         history-up
bind editor         \cN         history-down

# PATCHES
# ------------------------------
# sidebar
# nntp
# nntp stat fix
# compressed folders
# format for initials of author (%I)
# smarter quote (quote_empty, quote_quoted)
# trash folder (trash)
# abort on missing attachments (abort_noattach, attach_keyword)
# write postponed (fixes postponing aspects)
# sendbox patchset (sendbox)
# conditional support (ifdef)
# feedback from scripts (echo)
# indexcolors - different color for columns in index
# purge message - bypass trash folder
# source multiple files in single call
# passphrase error fix
# show X-Face
# nested conditions
# conditional dates
# xterm title

# sidebar
set nosidebar_visible
set sidebar_width       = 30
bind index,pager    }           sidebar-next
bind index,pager    {           sidebar-prev
bind index,pager    \eo         sidebar-open
bind index,pager    \e<Return>  sidebar-open

# xterm
set xterm_set_titles
